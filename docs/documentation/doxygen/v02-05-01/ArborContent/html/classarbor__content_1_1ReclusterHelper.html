<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>ArborContent: arbor_content::ReclusterHelper Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ArborContent
   &#160;<span id="projectnumber">01.05.00</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacearbor__content.html">arbor_content</a></li><li class="navelem"><a class="el" href="classarbor__content_1_1ReclusterHelper.html">ReclusterHelper</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classarbor__content_1_1ReclusterHelper-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">arbor_content::ReclusterHelper Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classarbor__content_1_1ReclusterHelper.html" title="ReclusterHelper class. ">ReclusterHelper</a> class.  
 <a href="classarbor__content_1_1ReclusterHelper.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="ReclusterHelper_8h_source.html">ReclusterHelper.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:acefc10cd154fbebd5e1b087b14348938"><td class="memItemLeft" align="right" valign="top">static float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classarbor__content_1_1ReclusterHelper.html#acefc10cd154fbebd5e1b087b14348938">GetTrackClusterCompatibility</a> (const pandora::Pandora &amp;pandora, const pandora::Cluster *const pCluster, const pandora::TrackList &amp;trackList, float energyResolutionFactor=1.f)</td></tr>
<tr class="memdesc:acefc10cd154fbebd5e1b087b14348938"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate the compatibility of a cluster with its associated tracks.  <a href="#acefc10cd154fbebd5e1b087b14348938">More...</a><br /></td></tr>
<tr class="separator:acefc10cd154fbebd5e1b087b14348938"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfec8383d01946b6cc3b2a3146879a3b"><td class="memItemLeft" align="right" valign="top">static float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classarbor__content_1_1ReclusterHelper.html#acfec8383d01946b6cc3b2a3146879a3b">GetTrackClusterCompatibility</a> (const pandora::Pandora &amp;pandora, const float clusterEnergy, const float trackEnergy, float energyResolutionFactor=1.f)</td></tr>
<tr class="memdesc:acfec8383d01946b6cc3b2a3146879a3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate the compatibility of a cluster with its associated tracks.  <a href="#acfec8383d01946b6cc3b2a3146879a3b">More...</a><br /></td></tr>
<tr class="separator:acfec8383d01946b6cc3b2a3146879a3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ccd05ef055993c23f2a0d05386274da"><td class="memItemLeft" align="right" valign="top">static pandora::StatusCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classarbor__content_1_1ReclusterHelper.html#a7ccd05ef055993c23f2a0d05386274da">ExtractReclusterResults</a> (const pandora::Pandora &amp;pandora, const pandora::ClusterList &amp;clusterList, <a class="el" href="classarbor__content_1_1ReclusterResult.html">ReclusterResult</a> &amp;reclusterResult)</td></tr>
<tr class="memdesc:a7ccd05ef055993c23f2a0d05386274da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract the recluster result.  <a href="#a7ccd05ef055993c23f2a0d05386274da">More...</a><br /></td></tr>
<tr class="separator:a7ccd05ef055993c23f2a0d05386274da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbb0ece8d637fcbe717bbf16312fc197"><td class="memItemLeft" align="right" valign="top">static pandora::StatusCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classarbor__content_1_1ReclusterHelper.html#abbb0ece8d637fcbe717bbf16312fc197">SplitTreeFromCluster</a> (const pandora::Algorithm &amp;algorithm, const <a class="el" href="classarbor__content_1_1CaloHit.html">arbor_content::CaloHit</a> *const pSeedCaloHit, const pandora::Cluster *const pOriginalCluster, const pandora::Cluster *&amp;pSeparatedTreeCluster, const std::string &amp;originalClusterListName=&quot;&quot;)</td></tr>
<tr class="memdesc:abbb0ece8d637fcbe717bbf16312fc197"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a separated tree cluster from a seed calo hit contained in an original cluster.  <a href="#abbb0ece8d637fcbe717bbf16312fc197">More...</a><br /></td></tr>
<tr class="separator:abbb0ece8d637fcbe717bbf16312fc197"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8089ad7a72584d155f20d3edca225c7"><td class="memItemLeft" align="right" valign="top">static pandora::StatusCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classarbor__content_1_1ReclusterHelper.html#ad8089ad7a72584d155f20d3edca225c7">SplitClusterIntoTreeClusters</a> (const pandora::Algorithm &amp;algorithm, const pandora::Cluster *const pCluster, pandora::ClusterVector &amp;treeClusterVector)</td></tr>
<tr class="memdesc:ad8089ad7a72584d155f20d3edca225c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a cluster list for each tree contained in the cluster Possible only if the cluster contains more than one tree (more than one seed calo hit)  <a href="#ad8089ad7a72584d155f20d3edca225c7">More...</a><br /></td></tr>
<tr class="separator:ad8089ad7a72584d155f20d3edca225c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classarbor__content_1_1ReclusterHelper.html" title="ReclusterHelper class. ">ReclusterHelper</a> class. </p>

<p>Definition at line <a class="el" href="ReclusterHelper_8h_source.html#l00128">128</a> of file <a class="el" href="ReclusterHelper_8h_source.html">ReclusterHelper.h</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a7ccd05ef055993c23f2a0d05386274da"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pandora::StatusCode arbor_content::ReclusterHelper::ExtractReclusterResults </td>
          <td>(</td>
          <td class="paramtype">const pandora::Pandora &amp;&#160;</td>
          <td class="paramname"><em>pandora</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pandora::ClusterList &amp;&#160;</td>
          <td class="paramname"><em>clusterList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classarbor__content_1_1ReclusterResult.html">ReclusterResult</a> &amp;&#160;</td>
          <td class="paramname"><em>reclusterResult</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extract the recluster result. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pandora</td><td>the pandora instance to access content </td></tr>
    <tr><td class="paramname">clusterList</td><td>the newly created clusters after a reclustering step </td></tr>
    <tr><td class="paramname">reclusterResult</td><td>the recluster results </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ReclusterHelper_8cc_source.html#l00072">72</a> of file <a class="el" href="ReclusterHelper_8cc_source.html">ReclusterHelper.cc</a>.</p>

<p>References <a class="el" href="ReclusterHelper_8cc_source.html#l00035">GetTrackClusterCompatibility()</a>, <a class="el" href="ReclusterHelper_8h_source.html#l00279">arbor_content::ReclusterResult::SetChargedEnergy()</a>, <a class="el" href="ReclusterHelper_8h_source.html#l00244">arbor_content::ReclusterResult::SetChi()</a>, <a class="el" href="ReclusterHelper_8h_source.html#l00251">arbor_content::ReclusterResult::SetChi2()</a>, <a class="el" href="ReclusterHelper_8h_source.html#l00265">arbor_content::ReclusterResult::SetChi2PerDof()</a>, <a class="el" href="ReclusterHelper_8h_source.html#l00258">arbor_content::ReclusterResult::SetChiPerDof()</a>, <a class="el" href="ReclusterHelper_8h_source.html#l00286">arbor_content::ReclusterResult::SetChiWorstAssociation()</a>, and <a class="el" href="ReclusterHelper_8h_source.html#l00272">arbor_content::ReclusterResult::SetNeutralEnergy()</a>.</p>

<p>Referenced by <a class="el" href="MissingEnergyReclusteringAlgorithm_8cc_source.html#l00041">arbor_content::MissingEnergyReclusteringAlgorithm::Run()</a>.</p>
<div class="fragment"><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">if</span>(clusterList.empty())</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <span class="keywordflow">return</span> pandora::STATUS_CODE_INVALID_PARAMETER;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nDof(0);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordtype">float</span> chi(0.f), chi2(0.f), neutralEnergy(0.f), chargedEnergy(0.f), chiWorstAssociation(0.f);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordflow">for</span>(pandora::ClusterList::const_iterator iter = clusterList.begin(), endIter = clusterList.end() ; endIter != iter ; ++iter)</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keyword">const</span> pandora::Cluster *<span class="keyword">const</span> pCluster = *iter;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">float</span> clusterEnergy(pCluster-&gt;GetCorrectedHadronicEnergy(<a class="code" href="namespacepandora.html">pandora</a>));</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacearbor__content.html#a95b0ee4bc1851c47069bdafdbf53c817">pandora::TrackList</a> &amp;trackList(pCluster-&gt;GetAssociatedTrackList());</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nTracks(trackList.size());</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <span class="keywordflow">if</span>(nTracks == 0)</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        neutralEnergy += clusterEnergy;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      chargedEnergy += clusterEnergy;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">float</span> newChi(<a class="code" href="classarbor__content_1_1ReclusterHelper.html#acefc10cd154fbebd5e1b087b14348938">ReclusterHelper::GetTrackClusterCompatibility</a>(<a class="code" href="namespacepandora.html">pandora</a>, pCluster, trackList));</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      chi += newChi;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      chi2 += newChi * newChi;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      ++nDof;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="keywordflow">if</span>( (newChi * newChi) &gt; chiWorstAssociation*chiWorstAssociation )</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        chiWorstAssociation = newChi;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">if</span>(0 == nDof)</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <span class="keywordflow">return</span> pandora::STATUS_CODE_FAILURE;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    reclusterResult.SetChi(chi);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    reclusterResult.SetChi2(chi2);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    reclusterResult.SetChiPerDof(chi / nDof);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    reclusterResult.SetChi2PerDof(chi2 / nDof);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    reclusterResult.SetNeutralEnergy(neutralEnergy);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    reclusterResult.SetChargedEnergy(chargedEnergy);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    reclusterResult.SetChiWorstAssociation(chiWorstAssociation);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">return</span> pandora::STATUS_CODE_SUCCESS;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  }</div>
<div class="ttc" id="classarbor__content_1_1ReclusterHelper_html_acefc10cd154fbebd5e1b087b14348938"><div class="ttname"><a href="classarbor__content_1_1ReclusterHelper.html#acefc10cd154fbebd5e1b087b14348938">arbor_content::ReclusterHelper::GetTrackClusterCompatibility</a></div><div class="ttdeci">static float GetTrackClusterCompatibility(const pandora::Pandora &amp;pandora, const pandora::Cluster *const pCluster, const pandora::TrackList &amp;trackList, float energyResolutionFactor=1.f)</div><div class="ttdoc">Evaluate the compatibility of a cluster with its associated tracks. </div><div class="ttdef"><b>Definition:</b> <a href="ReclusterHelper_8cc_source.html#l00035">ReclusterHelper.cc:35</a></div></div>
<div class="ttc" id="namespacepandora_html"><div class="ttname"><a href="namespacepandora.html">pandora</a></div><div class="ttdef"><b>Definition:</b> <a href="ArborInputTypes_8h_source.html#l00102">ArborInputTypes.h:102</a></div></div>
<div class="ttc" id="namespacearbor__content_html_a95b0ee4bc1851c47069bdafdbf53c817"><div class="ttname"><a href="namespacearbor__content.html#a95b0ee4bc1851c47069bdafdbf53c817">arbor_content::TrackList</a></div><div class="ttdeci">std::set&lt; const Track * &gt; TrackList</div><div class="ttdef"><b>Definition:</b> <a href="ArborInputTypes_8h_source.html#l00085">ArborInputTypes.h:85</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acefc10cd154fbebd5e1b087b14348938"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">float arbor_content::ReclusterHelper::GetTrackClusterCompatibility </td>
          <td>(</td>
          <td class="paramtype">const pandora::Pandora &amp;&#160;</td>
          <td class="paramname"><em>pandora</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pandora::Cluster *const&#160;</td>
          <td class="paramname"><em>pCluster</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pandora::TrackList &amp;&#160;</td>
          <td class="paramname"><em>trackList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>energyResolutionFactor</em> = <code>1.f</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Evaluate the compatibility of a cluster with its associated tracks. </p>
<p>Reclustering can be used to split up a cluster and produce more favourable track/cluster matches.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pandora</td><td>the associated pandora instance </td></tr>
    <tr><td class="paramname">pCluster</td><td>address of the cluster </td></tr>
    <tr><td class="paramname">trackList</td><td>address of the list of tracks associated with the cluster </td></tr>
    <tr><td class="paramname">energyResolutionFactory</td><td>the number of sigmas of resolution in the chi computation</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the chi value for the suitability of the track/cluster associations </dd></dl>

<p>Definition at line <a class="el" href="ReclusterHelper_8cc_source.html#l00035">35</a> of file <a class="el" href="ReclusterHelper_8cc_source.html">ReclusterHelper.cc</a>.</p>

<p>Referenced by <a class="el" href="TrackClusterAssociationAlgorithm_8cc_source.html#l00108">arbor_content::TrackClusterAssociationAlgorithm::BuildPossibleAssociations()</a>, <a class="el" href="TrackClusterAssociationAlgorithm_8cc_source.html#l00284">arbor_content::TrackClusterAssociationAlgorithm::CalculateAssociationConstraints()</a>, <a class="el" href="ReclusterHelper_8cc_source.html#l00072">ExtractReclusterResults()</a>, <a class="el" href="ClusterHelper_8cc_source.html#l00407">arbor_content::ClusterHelper::GetChiClusterMerging()</a>, <a class="el" href="SortingHelper_8cc_source.html#l00114">arbor_content::SortingHelper::SortByTrackClusterCompatibility::operator()()</a>, <a class="el" href="UnassociatedTrackRecoveryAlg_8cc_source.html#l00132">arbor_content::UnassociatedTrackRecoveryAlg::PerformPossibleTrackClusterAssociations()</a>, <a class="el" href="PerformanceMonitoringAlgorithm_8cc_source.html#l00037">arbor_content::PerformanceMonitoringAlgorithm::Run()</a>, <a class="el" href="ClusterFragmentMergingAlgorithm_8cc_source.html#l00040">arbor_content::ClusterFragmentMergingAlgorithm::Run()</a>, <a class="el" href="LoopingTrackAssociationAlgorithm_8cc_source.html#l00037">arbor_content::LoopingTrackAssociationAlgorithm::Run()</a>, <a class="el" href="EnergyExcessReclusteringAlgorithm_8cc_source.html#l00041">arbor_content::EnergyExcessReclusteringAlgorithm::Run()</a>, and <a class="el" href="MissingEnergyReclusteringAlgorithm_8cc_source.html#l00041">arbor_content::MissingEnergyReclusteringAlgorithm::Run()</a>.</p>
<div class="fragment"><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordtype">float</span> trackEnergySum(0.);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordflow">for</span> (pandora::TrackList::const_iterator trackIter = trackList.begin(), trackIterEnd = trackList.end(); trackIter != trackIterEnd; ++trackIter)</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      trackEnergySum += (*trackIter)-&gt;GetEnergyAtDca();</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> hadronicEnergyResolution(<a class="code" href="namespacepandora.html">pandora</a>.GetSettings()-&gt;GetHadronicEnergyResolution());</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">if</span> ((trackEnergySum &lt; std::numeric_limits&lt;float&gt;::epsilon()) || (hadronicEnergyResolution &lt; std::numeric_limits&lt;float&gt;::epsilon()))</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      <span class="keywordflow">throw</span> pandora::StatusCodeException(pandora::STATUS_CODE_FAILURE);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> sigmaE(hadronicEnergyResolution * trackEnergySum / std::sqrt(trackEnergySum));</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> chi((pCluster-&gt;GetTrackComparisonEnergy(<a class="code" href="namespacepandora.html">pandora</a>) - trackEnergySum) / (energyResolutionFactor * sigmaE));</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">return</span> chi;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  }</div>
<div class="ttc" id="namespacepandora_html"><div class="ttname"><a href="namespacepandora.html">pandora</a></div><div class="ttdef"><b>Definition:</b> <a href="ArborInputTypes_8h_source.html#l00102">ArborInputTypes.h:102</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acfec8383d01946b6cc3b2a3146879a3b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">float arbor_content::ReclusterHelper::GetTrackClusterCompatibility </td>
          <td>(</td>
          <td class="paramtype">const pandora::Pandora &amp;&#160;</td>
          <td class="paramname"><em>pandora</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>clusterEnergy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>trackEnergy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>energyResolutionFactor</em> = <code>1.f</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Evaluate the compatibility of a cluster with its associated tracks. </p>
<p>Reclustering can be used to split up a cluster and produce more favourable track/cluster matches.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pandora</td><td>the associated pandora instance </td></tr>
    <tr><td class="paramname">clusterEnergy</td><td>the cluster energy </td></tr>
    <tr><td class="paramname">trackEnergy</td><td>the sum of the energies of the associated tracks </td></tr>
    <tr><td class="paramname">energyResolutionFactory</td><td>the number of sigmas of resolution in the chi computation</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the chi value for the suitability of the track/cluster associations </dd></dl>

<p>Definition at line <a class="el" href="ReclusterHelper_8cc_source.html#l00056">56</a> of file <a class="el" href="ReclusterHelper_8cc_source.html">ReclusterHelper.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> hadronicEnergyResolution(<a class="code" href="namespacepandora.html">pandora</a>.GetSettings()-&gt;GetHadronicEnergyResolution());</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordflow">if</span> ((trackEnergy &lt; std::numeric_limits&lt;float&gt;::epsilon()) || (hadronicEnergyResolution &lt; std::numeric_limits&lt;float&gt;::epsilon()))</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordflow">throw</span> pandora::StatusCodeException(pandora::STATUS_CODE_FAILURE);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> sigmaE(hadronicEnergyResolution * trackEnergy / std::sqrt(trackEnergy));</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> chi((clusterEnergy - trackEnergy) / (energyResolutionFactor * sigmaE));</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">return</span> chi;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  }</div>
<div class="ttc" id="namespacepandora_html"><div class="ttname"><a href="namespacepandora.html">pandora</a></div><div class="ttdef"><b>Definition:</b> <a href="ArborInputTypes_8h_source.html#l00102">ArborInputTypes.h:102</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad8089ad7a72584d155f20d3edca225c7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pandora::StatusCode arbor_content::ReclusterHelper::SplitClusterIntoTreeClusters </td>
          <td>(</td>
          <td class="paramtype">const pandora::Algorithm &amp;&#160;</td>
          <td class="paramname"><em>algorithm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pandora::Cluster *const&#160;</td>
          <td class="paramname"><em>pCluster</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pandora::ClusterVector &amp;&#160;</td>
          <td class="paramname"><em>treeClusterVector</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a cluster list for each tree contained in the cluster Possible only if the cluster contains more than one tree (more than one seed calo hit) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">algorithm</td><td>the algorithm instance used to access pandora content </td></tr>
    <tr><td class="paramname">pCluster</td><td>the cluster to split </td></tr>
    <tr><td class="paramname">treeClusterVector</td><td>the split list of tree clusters </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ReclusterHelper_8cc_source.html#l00187">187</a> of file <a class="el" href="ReclusterHelper_8cc_source.html">ReclusterHelper.cc</a>.</p>

<p>References <a class="el" href="CaloHitHelper_8cc_source.html#l00133">arbor_content::CaloHitHelper::BuildCaloHitList()</a>, <a class="el" href="CaloHitHelper_8cc_source.html#l00082">arbor_content::CaloHitHelper::ExtractSeedCaloHitList()</a>, and <a class="el" href="ArborInputTypes_8h_source.html#l00059">arbor_content::FORWARD_DIRECTION</a>.</p>
<div class="fragment"><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">if</span>(NULL == pCluster)</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="keywordflow">return</span> pandora::STATUS_CODE_INVALID_PARAMETER;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <a class="code" href="namespacearbor__content.html#a4a7f6aee4a2ba012d04b504df873974e">pandora::CaloHitList</a> clusterCaloHitList;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <a class="code" href="namespacearbor__content.html#a4a7f6aee4a2ba012d04b504df873974e">pandora::CaloHitList</a> seedCaloHitList;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    pCluster-&gt;GetOrderedCaloHitList().GetCaloHitList(clusterCaloHitList);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    PANDORA_RETURN_RESULT_IF(pandora::STATUS_CODE_SUCCESS, !=, <a class="code" href="classarbor__content_1_1CaloHitHelper.html#a89ea31f657c7a3ad0e2b3d4efde798d3">CaloHitHelper::ExtractSeedCaloHitList</a>(&amp;clusterCaloHitList, seedCaloHitList, <span class="keyword">false</span>));</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">// if only one seed in the original cluster, can&#39;t create a separate tree from this cluster</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">if</span>(seedCaloHitList.size() &lt;= 1)</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="keywordflow">return</span> pandora::STATUS_CODE_NOT_ALLOWED;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    pandora::ClusterList reclusterClusterList;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    reclusterClusterList.insert(pCluster);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    std::string originalClusterListName;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    std::string fragmentsClustersListName;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">// fragment the cluster</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    PANDORA_RETURN_RESULT_IF(pandora::STATUS_CODE_SUCCESS, !=, PandoraContentApi::InitializeFragmentation(algorithm, reclusterClusterList, originalClusterListName, fragmentsClustersListName));</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">for</span>(pandora::CaloHitList::const_iterator iter = seedCaloHitList.begin(), endIter = seedCaloHitList.end() ;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        endIter != iter ; ++iter)</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="keyword">const</span> <a class="code" href="classarbor__content_1_1CaloHit.html">arbor_content::CaloHit</a> *<span class="keyword">const</span> pCaloHit = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classarbor__content_1_1CaloHit.html">arbor_content::CaloHit</a> *const<span class="keyword">&gt;</span>(*iter);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="keywordflow">if</span>(NULL == pCaloHit)</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keywordflow">return</span> pandora::STATUS_CODE_FAILURE;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <a class="code" href="namespacearbor__content.html#a4a7f6aee4a2ba012d04b504df873974e">pandora::CaloHitList</a> treeCaloHitList;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      treeCaloHitList.insert(pCaloHit);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      PANDORA_RETURN_RESULT_IF(pandora::STATUS_CODE_SUCCESS, !=, <a class="code" href="classarbor__content_1_1CaloHitHelper.html#a5cba7945199b23c6760e08eb4f6aceeb">CaloHitHelper::BuildCaloHitList</a>(pCaloHit, <a class="code" href="namespacearbor__content.html#a4ae355bbdbe38e0bc71d1a10dde87ba9af04dbae4542c1cbe191cdff43d4599a0">FORWARD_DIRECTION</a>, treeCaloHitList));</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="comment">// create a separated tree cluster</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      PandoraContentApi::ClusterParameters clusterParameters;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      clusterParameters.m_caloHitList = treeCaloHitList;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <span class="keyword">const</span> pandora::Cluster *pTreeCluster = NULL;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      PANDORA_RETURN_RESULT_IF(pandora::STATUS_CODE_SUCCESS, !=, PandoraContentApi::Cluster::Create(algorithm, clusterParameters, pTreeCluster));</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      treeClusterVector.push_back(pTreeCluster);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">// save fragmented clusters</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    PANDORA_RETURN_RESULT_IF(pandora::STATUS_CODE_SUCCESS, !=, PandoraContentApi::EndFragmentation(algorithm, fragmentsClustersListName, originalClusterListName));</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">return</span> pandora::STATUS_CODE_SUCCESS;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  }</div>
<div class="ttc" id="classarbor__content_1_1CaloHit_html"><div class="ttname"><a href="classarbor__content_1_1CaloHit.html">arbor_content::CaloHit</a></div><div class="ttdoc">CaloHit class. </div><div class="ttdef"><b>Definition:</b> <a href="CaloHit_8h_source.html#l00051">CaloHit.h:51</a></div></div>
<div class="ttc" id="classarbor__content_1_1CaloHitHelper_html_a5cba7945199b23c6760e08eb4f6aceeb"><div class="ttname"><a href="classarbor__content_1_1CaloHitHelper.html#a5cba7945199b23c6760e08eb4f6aceeb">arbor_content::CaloHitHelper::BuildCaloHitList</a></div><div class="ttdeci">static pandora::StatusCode BuildCaloHitList(const CaloHit *const pCaloHit, ConnectorDirection direction, pandora::CaloHitList &amp;calohitList)</div><div class="ttdoc">Build the calo hit list starting from a calo hit by looking recursively in the connector list (forwar...</div><div class="ttdef"><b>Definition:</b> <a href="CaloHitHelper_8cc_source.html#l00133">CaloHitHelper.cc:133</a></div></div>
<div class="ttc" id="namespacearbor__content_html_a4ae355bbdbe38e0bc71d1a10dde87ba9af04dbae4542c1cbe191cdff43d4599a0"><div class="ttname"><a href="namespacearbor__content.html#a4ae355bbdbe38e0bc71d1a10dde87ba9af04dbae4542c1cbe191cdff43d4599a0">arbor_content::FORWARD_DIRECTION</a></div><div class="ttdef"><b>Definition:</b> <a href="ArborInputTypes_8h_source.html#l00059">ArborInputTypes.h:59</a></div></div>
<div class="ttc" id="namespacearbor__content_html_a4a7f6aee4a2ba012d04b504df873974e"><div class="ttname"><a href="namespacearbor__content.html#a4a7f6aee4a2ba012d04b504df873974e">arbor_content::CaloHitList</a></div><div class="ttdeci">std::set&lt; const CaloHit * &gt; CaloHitList</div><div class="ttdef"><b>Definition:</b> <a href="ArborInputTypes_8h_source.html#l00082">ArborInputTypes.h:82</a></div></div>
<div class="ttc" id="classarbor__content_1_1CaloHitHelper_html_a89ea31f657c7a3ad0e2b3d4efde798d3"><div class="ttname"><a href="classarbor__content_1_1CaloHitHelper.html#a89ea31f657c7a3ad0e2b3d4efde798d3">arbor_content::CaloHitHelper::ExtractSeedCaloHitList</a></div><div class="ttdeci">static pandora::StatusCode ExtractSeedCaloHitList(const pandora::CaloHitList *const pCaloHitList, pandora::CaloHitList &amp;seedCaloHitList, bool discriminateLeafHits=false)</div><div class="ttdoc">Extract the calo hit seed list from the calo hit list. </div><div class="ttdef"><b>Definition:</b> <a href="CaloHitHelper_8cc_source.html#l00082">CaloHitHelper.cc:82</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abbb0ece8d637fcbe717bbf16312fc197"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pandora::StatusCode arbor_content::ReclusterHelper::SplitTreeFromCluster </td>
          <td>(</td>
          <td class="paramtype">const pandora::Algorithm &amp;&#160;</td>
          <td class="paramname"><em>algorithm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classarbor__content_1_1CaloHit.html">arbor_content::CaloHit</a> *const&#160;</td>
          <td class="paramname"><em>pSeedCaloHit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pandora::Cluster *const&#160;</td>
          <td class="paramname"><em>pOriginalCluster</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pandora::Cluster *&amp;&#160;</td>
          <td class="paramname"><em>pSeparatedTreeCluster</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>originalClusterListName</em> = <code>&quot;&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a separated tree cluster from a seed calo hit contained in an original cluster. </p>
<p>Possible only if the original cluster contains more than one tree (more than one seed calo hit). Calo hits of the newly created tree cluster are removed from the original one</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">algorithm</td><td>the algorithm instance used to access pandora content </td></tr>
    <tr><td class="paramname">pSeedCaloHit</td><td>the seed calo hit pointer to build the separated tree from </td></tr>
    <tr><td class="paramname">pOriginalCluster</td><td>the original cluster pointer from which to separate the tree </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ReclusterHelper_8cc_source.html#l00123">123</a> of file <a class="el" href="ReclusterHelper_8cc_source.html">ReclusterHelper.cc</a>.</p>

<p>References <a class="el" href="CaloHitHelper_8cc_source.html#l00133">arbor_content::CaloHitHelper::BuildCaloHitList()</a>, <a class="el" href="CaloHitHelper_8cc_source.html#l00082">arbor_content::CaloHitHelper::ExtractSeedCaloHitList()</a>, <a class="el" href="ArborInputTypes_8h_source.html#l00059">arbor_content::FORWARD_DIRECTION</a>, and <a class="el" href="ArborContentApi_8cc_source.html#l00106">ArborContentApi::IsSeed()</a>.</p>
<div class="fragment"><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordflow">if</span>(NULL == pOriginalCluster || NULL == pSeedCaloHit)</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="keywordflow">return</span> pandora::STATUS_CODE_INVALID_PARAMETER;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="classArborContentApi.html#a2de8e2c53719f3235a956fdf8cfe652e">ArborContentApi::IsSeed</a>(pSeedCaloHit))</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="keywordflow">return</span> pandora::STATUS_CODE_INVALID_PARAMETER;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="namespacearbor__content.html#a4a7f6aee4a2ba012d04b504df873974e">pandora::CaloHitList</a> clusterCaloHitList;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="namespacearbor__content.html#a4a7f6aee4a2ba012d04b504df873974e">pandora::CaloHitList</a> seedCaloHitList;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    pOriginalCluster-&gt;GetOrderedCaloHitList().GetCaloHitList(clusterCaloHitList);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    PANDORA_RETURN_RESULT_IF(pandora::STATUS_CODE_SUCCESS, !=, <a class="code" href="classarbor__content_1_1CaloHitHelper.html#a89ea31f657c7a3ad0e2b3d4efde798d3">CaloHitHelper::ExtractSeedCaloHitList</a>(&amp;clusterCaloHitList, seedCaloHitList, <span class="keyword">false</span>));</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">// if only one seed in the original cluster, can&#39;t create a separate tree from this cluster</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordflow">if</span>(seedCaloHitList.size() &lt;= 1)</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="keywordflow">return</span> pandora::STATUS_CODE_NOT_ALLOWED;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">// seed calo hit must be contained in the original cluster</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordflow">if</span>(seedCaloHitList.end() == seedCaloHitList.find(pSeedCaloHit))</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <span class="keywordflow">return</span> pandora::STATUS_CODE_FAILURE;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="namespacearbor__content.html#a4a7f6aee4a2ba012d04b504df873974e">pandora::CaloHitList</a> treeCaloHitList;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    treeCaloHitList.insert(pSeedCaloHit);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    PANDORA_RETURN_RESULT_IF(pandora::STATUS_CODE_SUCCESS, !=, <a class="code" href="classarbor__content_1_1CaloHitHelper.html#a5cba7945199b23c6760e08eb4f6aceeb">CaloHitHelper::BuildCaloHitList</a>(pSeedCaloHit, <a class="code" href="namespacearbor__content.html#a4ae355bbdbe38e0bc71d1a10dde87ba9af04dbae4542c1cbe191cdff43d4599a0">FORWARD_DIRECTION</a>, treeCaloHitList));</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">// remove all the hits from the original cluster</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">for</span>(pandora::CaloHitList::const_iterator iter = treeCaloHitList.begin(), endIter = treeCaloHitList.end() ;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        endIter != iter ; ++iter)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      PANDORA_RETURN_RESULT_IF(pandora::STATUS_CODE_SUCCESS, !=, PandoraContentApi::RemoveFromCluster(algorithm, pOriginalCluster, *iter));</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// create the separated tree cluster</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    PandoraContentApi::ClusterParameters clusterParameters;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    clusterParameters.m_caloHitList = treeCaloHitList;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    pSeparatedTreeCluster = NULL;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    std::string clusterListName;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    std::string temporaryClusterListName;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keyword">const</span> pandora::ClusterList *pTemporaryClusterList = NULL;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">// in order to create a separate tree cluster, cluster creation must be enabled by pandora sdk first</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">if</span>(originalClusterListName.empty())</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      PANDORA_RETURN_RESULT_IF(pandora::STATUS_CODE_SUCCESS, !=, PandoraContentApi::GetCurrentListName&lt;pandora::Cluster&gt;(algorithm, clusterListName));</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      clusterListName = originalClusterListName;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    PANDORA_RETURN_RESULT_IF(pandora::STATUS_CODE_SUCCESS, !=, PandoraContentApi::CreateTemporaryListAndSetCurrent(algorithm, pTemporaryClusterList, temporaryClusterListName));</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="comment">// create the tree cluster and save it</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    PANDORA_RETURN_RESULT_IF(pandora::STATUS_CODE_SUCCESS, !=, PandoraContentApi::Cluster::Create(algorithm, clusterParameters, pSeparatedTreeCluster));</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    PANDORA_RETURN_RESULT_IF(pandora::STATUS_CODE_SUCCESS, !=, PandoraContentApi::SaveList&lt;pandora::Cluster&gt;(algorithm, temporaryClusterListName, clusterListName));</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">return</span> pandora::STATUS_CODE_SUCCESS;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  }</div>
<div class="ttc" id="classArborContentApi_html_a2de8e2c53719f3235a956fdf8cfe652e"><div class="ttname"><a href="classArborContentApi.html#a2de8e2c53719f3235a956fdf8cfe652e">ArborContentApi::IsSeed</a></div><div class="ttdeci">static bool IsSeed(const arbor_content::CaloHit *const pCaloHit)</div><div class="ttdoc">Whether the calo hit is a seed calo hit in the tree. </div><div class="ttdef"><b>Definition:</b> <a href="ArborContentApi_8cc_source.html#l00106">ArborContentApi.cc:106</a></div></div>
<div class="ttc" id="classarbor__content_1_1CaloHitHelper_html_a5cba7945199b23c6760e08eb4f6aceeb"><div class="ttname"><a href="classarbor__content_1_1CaloHitHelper.html#a5cba7945199b23c6760e08eb4f6aceeb">arbor_content::CaloHitHelper::BuildCaloHitList</a></div><div class="ttdeci">static pandora::StatusCode BuildCaloHitList(const CaloHit *const pCaloHit, ConnectorDirection direction, pandora::CaloHitList &amp;calohitList)</div><div class="ttdoc">Build the calo hit list starting from a calo hit by looking recursively in the connector list (forwar...</div><div class="ttdef"><b>Definition:</b> <a href="CaloHitHelper_8cc_source.html#l00133">CaloHitHelper.cc:133</a></div></div>
<div class="ttc" id="namespacearbor__content_html_a4ae355bbdbe38e0bc71d1a10dde87ba9af04dbae4542c1cbe191cdff43d4599a0"><div class="ttname"><a href="namespacearbor__content.html#a4ae355bbdbe38e0bc71d1a10dde87ba9af04dbae4542c1cbe191cdff43d4599a0">arbor_content::FORWARD_DIRECTION</a></div><div class="ttdef"><b>Definition:</b> <a href="ArborInputTypes_8h_source.html#l00059">ArborInputTypes.h:59</a></div></div>
<div class="ttc" id="namespacearbor__content_html_a4a7f6aee4a2ba012d04b504df873974e"><div class="ttname"><a href="namespacearbor__content.html#a4a7f6aee4a2ba012d04b504df873974e">arbor_content::CaloHitList</a></div><div class="ttdeci">std::set&lt; const CaloHit * &gt; CaloHitList</div><div class="ttdef"><b>Definition:</b> <a href="ArborInputTypes_8h_source.html#l00082">ArborInputTypes.h:82</a></div></div>
<div class="ttc" id="classarbor__content_1_1CaloHitHelper_html_a89ea31f657c7a3ad0e2b3d4efde798d3"><div class="ttname"><a href="classarbor__content_1_1CaloHitHelper.html#a89ea31f657c7a3ad0e2b3d4efde798d3">arbor_content::CaloHitHelper::ExtractSeedCaloHitList</a></div><div class="ttdeci">static pandora::StatusCode ExtractSeedCaloHitList(const pandora::CaloHitList *const pCaloHitList, pandora::CaloHitList &amp;seedCaloHitList, bool discriminateLeafHits=false)</div><div class="ttdoc">Extract the calo hit seed list from the calo hit list. </div><div class="ttdef"><b>Definition:</b> <a href="CaloHitHelper_8cc_source.html#l00082">CaloHitHelper.cc:82</a></div></div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="ReclusterHelper_8h_source.html">ReclusterHelper.h</a></li>
<li><a class="el" href="ReclusterHelper_8cc_source.html">ReclusterHelper.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Dec 12 2016 19:44:56 for ArborContent by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
